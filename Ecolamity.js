Math.genRndNum=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},Object.throwImplementationError=function(t,e){throw ReferenceError("'"+e+"' has not been implemented by "+t)},Object.validateClass=function(t,e){for(var o=0;o<e.length;o++)void 0===t[e[o]]&&Object.throwImplementationError(t.constructor.name,e[o])};var DOMUtility=function(){};DOMUtility.isMouseDown=!1,DOMUtility.assignElementById=function(t){var e=document.getElementById(t);if(null===e)throw ReferenceError(t+" is not a valid element.");return e},DOMUtility.createDivWithClass=function(t){var e=document.createElement("DIV");return e.className=t,e},DOMUtility.loadHtmlTemplate=function(t,e){var o=new XMLHttpRequest;o.open("GET",t+".html"),o.responseType="text",o.send(),o.onreadystatechange=function(){null!==o.response&&(document.body.innerHTML=o.responseText,4===o.readyState&&e())}},DOMUtility.disableRightClickMenu=function(){document.body.addEventListener("contextmenu",function(t){t.preventDefault()})},DOMUtility.preventElementHighlighting=function(){document.body.addEventListener("mousedown",function(t){t.preventDefault(),DOMUtility.isMouseDown=!0}),document.body.addEventListener("mouseup",function(){DOMUtility.isMouseDown=!1})},DOMUtility.listenForImageLoadFailure=function(){document.body.addEventListener("error",function(t){if("IMG"===t.target.tagName)throw ReferenceError(t.target.src+" is not a valid image.")},!0)};var Position=function(t,e){this._row=t,this._col=e};Position.prototype={constructor:Position,get row(){return this._row},get col(){return this._col},set row(t){this._row=this._setValue(t)},set col(t){this._col=this._setValue(t)},clone:function(){return new Position(this._row,this._col)},equals:function(t){return this._row==t.row&&this._col==t.col},setNewPosition:function(t,e){this._row=this._setValue(t),this._col=this._setValue(e)},_setValue:function(t){if(isNaN(t))throw TypeError("Attempted to set a non-numeric value.");return t}};var FoodMeter=function(t){this._level=t};FoodMeter.prototype={_maxLevel:4,_minLevel:0,get level(){return this._level},get maxLevel(){return this._maxLevel},get minLevel(){return this._minLevel},dec:function(){return!this.isEmpty()&&(this._level--,!0)},inc:function(){return!this.isFull()&&(this._level++,!0)},isEmpty:function(){return this._level===this._minLevel},isFull:function(){return this._level===this._maxLevel}};var Sprite=function(t,e,o){this._fileName=t,this._image=this._setSprite(),this._tileLength=e,this._tileWidth=o};Sprite.prototype={constructor:Sprite,_directory:"images/sprites/",get image(){return this._image},get tileLength(){return this._tileLength},get tileWidth(){return this._tileWidth},_setSprite:function(){return this._setImage(this._fileName)},_setImage:function(t){var e=document.createElement("img");return e.src=this._directory+t,e},getImageCopy:function(){return this._image.cloneNode()}};var ObstacleSprite=function(t,e,o){Sprite.call(this,t,e,o)};ObstacleSprite.prototype=Object.create(Sprite.prototype),ObstacleSprite.prototype.constructor=ObstacleSprite,ObstacleSprite.prototype._directory="images/obstacles/";var AnimatedSprite=function(t,e,o,i){Sprite.call(this,t,o,i),this._sheetFileName=e,this._sheet=this._setSheet(),this._numFrames=3};AnimatedSprite.prototype=Object.create(Sprite.prototype),AnimatedSprite.prototype.constructor=AnimatedSprite,Object.defineProperties(AnimatedSprite.prototype,{numFrames:{get:function(){return this._numFrames}},sheet:{get:function(){return this._sheet}}}),AnimatedSprite.prototype._setSheet=function(){return this._setImage(this._sheetFileName)};var MoveSpeed=function(t,e){this._maxSpeed=t,this._minSpeed=e,this._validateCoefficients()};MoveSpeed.prototype={constructor:MoveSpeed,_maxCoeff:.1,_minCoeff:8,_validateCoefficients:function(){if(this._maxSpeed<this._maxCoeff||this._minSpeed>this._minCoeff)throw RangeError("Movespeed coefficients must be a value between "+this._maxCoeff+" and "+this._minCoeff);if(this._maxSpeed>this._minSpeed)throw RangeError("MaxSpeed coefficient must be a value lower than MinSpeed")},getMax:function(t){return t*this._maxSpeed},getMin:function(t){return t*this._minSpeed},getRandom:function(t){return Math.genRndNum(this.getMax(t),this.getMin(t))}};var HungerBasedMoveSpeed=function(t){MoveSpeed.call(this,1,1),this._foodMeter=t,this._currentMeterLevel=this._foodMeter.level,this._setSpeed()};HungerBasedMoveSpeed.prototype=Object.create(MoveSpeed.prototype),HungerBasedMoveSpeed.prototype.constructor=HungerBasedMoveSpeed,HungerBasedMoveSpeed.prototype.getMax=function(t){return this._currentMeterLevel!=this._foodMeter.level&&this._setSpeed(),MoveSpeed.prototype.getMax.call(this,t)},HungerBasedMoveSpeed.prototype.getMin=function(t){return this._currentMeterLevel!=this._foodMeter.level&&this._setSpeed(),MoveSpeed.prototype.getMin.call(this,t)},HungerBasedMoveSpeed.prototype._setSpeed=function(){var t=this._foodMeter.level;this._minSpeed=this._speedFormula(t-1),this._maxSpeed=this._speedFormula(t-2),this._currentMeterLevel=t},HungerBasedMoveSpeed.prototype._speedFormula=function(t){return Math.pow(2,t)};var Obstacle=function(t){this._position=t};Obstacle.prototype={constructor:Obstacle,_sprite:void 0,get position(){return this._position.clone()},get sprite(){return this._sprite}};var List=function(){this._values=[]};List.prototype={constructor:List,get length(){return this._values.length},add:function(t){this._values.push(t)},get:function(t){return this._values[t]},remove:function(t){this._removeFromIndex(t)},_removeFromIndex:function(t){if(!this._isValidIndex())throw RangeError("Attempted to remove an element at an invalid index.");for(var e=t+1,o=this._values.length;e<o;e++)this._values[e-1]=this._values[e];this._values.pop()},_isValidIndex:function(t){return!(t<0||t>=this._values.length)}};var CreatureList=function(){List.call(this),this._numAnimals=0};CreatureList.prototype=Object.create(List.prototype),CreatureList.prototype.constructor=CreatureList,CreatureList.prototype.add=function(t){if(!(t instanceof Creature))throw TypeError("creature is not a Creature");t instanceof Animal&&this._numAnimals++,List.prototype.add.call(this,t)},CreatureList.prototype.remove=function(t){var e=this._values.indexOf(t);this._removeFromIndex(e),t instanceof Animal&&this._numAnimals--},CreatureList.prototype.noAnimalsLeft=function(){return 0===this._numAnimals};var ObjectList=function(){List.call(this),this._numCreatures=0,this._numObstacles=0};ObjectList.prototype=Object.create(List.prototype),ObjectList.prototype.constructor=ObjectList,Object.defineProperties(Object.prototype,{numCreatures:{get:function(){return this._numCreatures}},numObstacles:{get:function(){return this._numObstacles}}}),ObjectList.prototype.add=function(t,e){this._incCount(t),List.prototype.add.call(this,{class:t,position:e})},ObjectList.prototype.remove=function(t){this._decCount(this._values[t].class),this._removeFromIndex(t)},ObjectList.prototype._decCount=function(t){this._changeCount(t,this._numCreatures-1,this._numObstacles-1)},ObjectList.prototype._incCount=function(t){this._changeCount(t,this._numCreatures+1,this._numObstacles+1)},ObjectList.prototype._changeCount=function(t,e,o){if(t.prototype instanceof Creature)this._numCreatures=e;else{if(!(t.prototype instanceof Obstacle))throw TypeError("ObjectClass is not a constructor for a Creature or Obstacle.");this._numObstacles=o}},ObjectList.prototype.indexOf=function(t){for(var e=0,o=this._values.length;e<o;e++)if(this._values[e].position.equals(t))return e;return-1};var GameCanvas=function(t,e,o){this._canvas=DOMUtility.assignElementById(t),this._canvas.height=this._canvas.scrollHeight,this._canvas.width=this._canvas.scrollWidth,this._pxTileSize=this._canvas.scrollWidth/e,this._frameInterval=this._pxTileSize/this._fps,this._showCreatureIndex=!1,this._context=this._canvas.getContext("2d"),this._context.fillStyle="white",this._context.font="bold 70% "+this._font,this._setBackgroundImage(o,e)};GameCanvas.prototype={_bgDirectory:"images/backgrounds/",_font:"ArcadeAlternate, serif",_fps:16,_setBackgroundImage:function(t,e){var o=this,i=document.createElement("IMG");i.src=this._bgDirectory+t,i.addEventListener("load",function(){var t=i.height/(e/(o._canvas.height/100)),r=i.width/(e/(o._canvas.height/100));o._canvas.style.background="url('"+i.src+"') top left / "+t+"px "+r+"px"})},clearTile:function(t){this._clearFromPosition(this._pxPos(t.col),this._pxPos(t.row))},_clearFromPosition:function(t,e){this._context.clearRect(t,e,this._pxTileSize,this._pxTileSize)},drawIndex:function(t,e){this._drawIndexOnPosition(t,this._pxPos(e.col),this._pxPos(e.row))},_drawIndexOnPosition:function(t,e,o){this._showCreatureIndex&&this._context.fillText(t,e+3,o+10)},drawSprite:function(t,e){this._context.drawImage(t.image,this._pxPos(e.col),this._pxPos(e.row),this._pxTileSize*t.tileWidth,this._pxTileSize*t.tileLength)},drawOutlines:function(){for(var t=this._canvas.height/this._pxTileSize,e=this._canvas.width/this._pxTileSize,o=new Position(0,0);o.row<t;o.row++)for(o.col=0;o.col<e;o.col++)this.drawOutlineAroundTile(o)},drawOutlineAroundTile:function(t){this._context.strokeRect(this._pxPos(t.col),this._pxPos(t.row),this._pxTileSize,this._pxTileSize)},_pxPos:function(t){return t*this._pxTileSize},disableMapInteraction:function(){this._canvas.onclick=null,this._canvas.oncontextmenu=null},enableMapInteraction:function(t,e){if(1!==t.length||1!==e.length)throw TypeError("ClickAction methods must have 1 arguments, consisting of map position.");var o=this;this._canvas.onclick=function(e){o._clickAction(e,t)},this._canvas.oncontextmenu=function(t){o._clickAction(t,e)}},_clickAction:function(t,e){var o=t.pageX-t.target.offsetLeft,i=t.pageY-t.target.offsetTop;e(new Position(this._tilePos(i),this._tilePos(o)))},_tilePos:function(t){return Math.floor(t/this._pxTileSize)},move:function(t,e,o,i,r,n){r=r/Game.prototype.defaultSpeed*(1e3/this._fps);var a,s=this,c=t.sidebarIndex,p=0,h=t.sprite.numFrames-1,u=this._pxPos(t.position.col),l=this._pxPos(t.position.row),_=o*this._frameInterval,d=i*this._frameInterval,m=0!==o?o>0?u+this._pxTileSize:u-this._pxTileSize:u,f=0!==i?i>0?l+this._pxTileSize:l-this._pxTileSize:l;if(0===i)a=o>0?function(){return m<=u+_}:function(){return u+_<=m};else{if(0!==o)return;a=i>0?function(){return f<=l+d}:function(){return l+d<=f}}var y=function(){s._clearFromPosition(u,l),u+=_,l+=d,s._drawAnimatedFrame(t.sprite,p,e,u,l),s._drawIndexOnPosition(c,u,l),p=p<h?p+1:0,a()?(s._clearFromPosition(u,l),u=m,l=f,s._drawAnimatedFrame(t.sprite,p,e,u,l),s._drawIndexOnPosition(c,u,l),n()):setTimeout(function(){requestAnimationFrame(y)},r)};requestAnimationFrame(y)},_drawAnimatedFrame:function(t,e,o,i,r){var n=t.image.height,a=t.image.width;this._context.drawImage(t.sheet,e*a,o*n,a,n,i,r,this._pxTileSize,this._pxTileSize)},showGameOverScreen:function(){var t=this._canvas.scrollWidth/2;this._context.font="50px "+this._font,this._context.fillText("GAME OVER",t/2,t)},toggleShowCreatureIndex:function(){this._showCreatureIndex=!this._showCreatureIndex}};var MapInterface=function(t,e){this._canvas=new GameCanvas(this._id,t,e),this._grid,this._size=t,this._createGrid()};MapInterface.prototype={constructor:MapInterface,_id:void 0,get size(){return this._size},_createGrid:function(){this._grid=[];for(var t=0;t<this._size;t++){this._grid.push([]);for(var e=0;e<this._size;e++)this._grid[t].push(0)}},clearLocation:function(t){if(!(t instanceof Creature))throw TypeError("'creature' is not an instance of a Creature.");this._removeObjectFromGrid(t,t.position),this._canvas.clearTile(t.position)},_removeObjectFromGrid:function(t,e){this._setOnGrid(t,0,e)},getAtLocation:function(t){return void 0===this._grid[t.row]||void 0===this._grid[t.row][t.col]?-1:this._grid[t.row][t.col]},setAtLocation:function(t,e){this._validateLocation(e),this._setObjectOnGrid(t,e),this._canvas.drawSprite(t.sprite,e),t instanceof Creature&&this._canvas.drawIndex(t.sidebarIndex,e)},_validateLocation:function(t){if(void 0===this._grid[t.row]||void 0===this._grid[t.row][t.col])throw RangeError("Value passed is outside the map index range.")},_setObjectOnGrid:function(t,e){this._setOnGrid(t,t,e)},_setOnGrid:function(t,e,o){for(var i=o.clone(),r=0,n=t.sprite.tileLength;r<n;r++){i.col=o.col;for(var a=0,s=t.sprite.tileWidth;a<s;a++)this._grid[i.row][i.col]=e,i.col++;i.row++}},printToConsole:function(t,e){if(refeshSpeed&&e)setInterval(function(){console.clear();for(var t=0;t<this._size;t++)console.log(this._grid[t])}.bind(this),t);else for(var o=0;o<this._size;o++)console.log(this._grid[o])}};var GameMap=function(t,e){MapInterface.call(this,t,e),this._canvas.toggleShowCreatureIndex()};GameMap.prototype=Object.create(MapInterface.prototype),GameMap.prototype.constructor=GameMap,GameMap.prototype._id="game-map",GameMap.prototype.moveCreatureUp=function(t,e){return this._move(t,0,0,-1,e)},GameMap.prototype.moveCreatureDown=function(t,e){return this._move(t,1,0,1,e)},GameMap.prototype.moveCreatureLeft=function(t,e){return this._move(t,2,-1,0,e)},GameMap.prototype.moveCreatureRight=function(t,e){return this._move(t,3,1,0,e)},GameMap.prototype._move=function(t,e,o,i,r){if(t.inAnimation)return!1;var n=new Position(t.position.row+i,t.position.col+o);if(0!==this.getAtLocation(n))return!1;var a=this;return t.toggleInAnimation(),this._grid[t.position.row][t.position.col]=-1,this._grid[n.row][n.col]=-1,this._canvas.move(t,e,o,i,r,function(){a._grid[t.position.row][t.position.col]=0,a._grid[n.row][n.col]=t,t.move(n),t.toggleInAnimation()}),!0},GameMap.prototype.showGameOverScreen=function(){this._canvas.showGameOverScreen()};var MapPreview=function(t,e,o,i){MapInterface.call(this,t,e),this._objectList=new ObjectList,void 0!==i&&this._applyObjectList(i),this._selectedSpecies=o,this._canvas.drawOutlines(),this._initiateInteraction()};MapPreview.prototype=Object.create(GameMap.prototype),Object.defineProperties(MapPreview.prototype,{objectList:{get:function(){return this._objectList}}}),MapPreview.prototype._id="map-preview",MapPreview.prototype._applyObjectList=function(t){for(var e,o=0,i=t.length;o<i;o++)e=t.get(o),this._placeObject(e.class,e.position)},MapPreview.prototype._initiateInteraction=function(){this._canvas.disableMapInteraction(),this._canvas.enableMapInteraction(this._placeSelectedSpecies.bind(this),this._removeCreature.bind(this))},MapPreview.prototype._placeSelectedSpecies=function(t){this._objectList.numCreatures<this._size-1&&this._placeObject(this._selectedSpecies,t)},MapPreview.prototype.newSelectedSpecies=function(t){if(!(t.prototype instanceof Creature))throw TypeError("'SpeciesClass' should be a constructor for a Creature");this._selectedSpecies=t},MapPreview.prototype.generateObstacles=function(t){if(!(t instanceof Game))throw TypeError("'envirProto' should be a prototype for a Game subclass");for(var e,o=new Position(0,0),i=Math.floor(this._size*this._size*t.obstaclePercent),r=t.obstacleList;i>0;){e=r[Math.genRndNum(0,r.length-1)];do{o.row=Math.genRndNum(0,this._size-1),o.col=Math.genRndNum(0,this._size-1)}while(!this._canPlaceObstacle(e,o));this._placeObject(e,o),i-=e.prototype.sprite.tileLength*e.prototype.sprite.tileWidth}},MapPreview.prototype._canPlaceObstacle=function(t,e){var o,i=e.clone(),r=t.prototype.sprite.tileLength;do{for(i.col=e.col,o=t.prototype.sprite.tileWidth;o>0&&0===this.getAtLocation(i);)i.col++,o--;i.row++,r--}while(r>0&&0===o);return 0===r&&0===o},MapPreview.prototype._placeObject=function(t,e){if(!(t.prototype instanceof Creature||t.prototype instanceof Obstacle))throw TypeError("'ObjectClass' should be a constructor for a Creature or Obstacle");if(e=e.clone(),0===this.getAtLocation(e)){var o=new t(e);this._objectList.add(t,e),this.setAtLocation(o,e)}},MapPreview.prototype.spawnRandomCreatures=function(t,e){var o,i=new Position(0,0);void 0===e&&(e=this._size-1),this.removeAllCreatures();for(var r=0;r<e;r++){o=Math.genRndNum(0,t.length-1);do{i.row=Math.genRndNum(0,this._size-1),i.col=Math.genRndNum(0,this._size-1)}while(0!==this.getAtLocation(i));this._placeObject(t[o],i)}},MapPreview.prototype.removeAllCreatures=function(){for(var t,e=0;e<this._objectList.length;e++)(t=this._objectList.get(e)).class.prototype instanceof Creature&&(this._removeCreature(t.position),e--)},MapPreview.prototype._removeCreature=function(t){var e=this._objectList.indexOf(t),o=this.getAtLocation(t);-1!==e&&o instanceof Creature&&(this.clearLocation(o),this._objectList.remove(e),this._canvas.drawOutlineAroundTile(t))};var Clock=function(t,e){this._actionPerHour=e,this._speedSlider=new SpeedSlider(t),this._day=1,this._hour=0,this._display=DOMUtility.assignElementById(this._id),this._timer=null,this._updateDisplay()};Clock.hoursPerDay=24,Clock.convertDaysToHours=function(t){return t*Clock.hoursPerDay},Clock.convertHoursToDays=function(t){return Math.floor(t/Clock.hoursPerDay)},Clock.prototype={_id:"time-display",get day(){return this._day},get hour(){return this._hour},get speed(){return this._speedSlider.currentSpeed},start:function(){this._timer=setTimeout(function(t){t._progress()},this.speed,this)},pause:function(){clearTimeout(this._timer),this._timer=null},reset:function(){this._day=1,this.hour=0,this._updateDisplay()},_progress:function(){this._incHour(),this._actionPerHour(),null!==this._timer&&this.start()},_incHour:function(){++this._hour>=Clock.hoursPerDay&&(this._hour=0,this._day++),this._updateDisplay()},_updateDisplay:function(){this._display.textContent="Day "+this._day+", Hour "+this._hour}};var SpeedSlider=function(t){this._currentSpeed=t,this._defaultSpeed=t,this._slider=DOMUtility.assignElementById(this._id),this._optionButtons=this._slider.getElementsByTagName("SPAN"),this._numOptions=this._optionButtons.length,this._checkIfOptionsValid(),this._initiateSlider()};SpeedSlider.prototype={_id:"speed-slider",_multiplierList:[1,1.5,2,4,8,15],get currentSpeed(){return this._currentSpeed},_checkIfOptionsValid:function(){if(this._numOptions!==this._multiplierList.length)throw RangeError("The number of multipliers does not match the number of speed options.")},_initiateSlider:function(){this._setBgColorToYellow(0);for(var t=0;t<this._numOptions;t++)this._optionButtons[t].addEventListener("mouseover",function(t,e){return function(){DOMUtility.isMouseDown&&t._adjustSlider(e)}}(this,t)),this._optionButtons[t].addEventListener("mousedown",function(t,e){return function(){t._adjustSlider(e)}}(this,t))},_adjustSlider:function(t){for(var e=0;e<=t;e++)this._setBgColorToYellow(e);for(var o=t+1;o<this._numOptions;o++)this._setBgColorToWhite(o);this._currentSpeed=this._defaultSpeed/this._multiplierList[t]},_setBgColorToWhite:function(t){this._setBgColor(t,"rgba(255,255,255,0.9)")},_setBgColorToYellow:function(t){this._setBgColor(t,"rgba(255,255,0,0.9)")},_setBgColor:function(t,e){this._optionButtons[t].style.backgroundColor=e}};var PauseButton=function(t,e){this._button=DOMUtility.assignElementById("pause-button"),this._setImage(this._pauseIMG),this._gamePaused=!1,this._resumeMethod=e,this._pauseMethod=t,this._initiate()};PauseButton.prototype={_imgDirectory:"images/buttons/",_pauseIMG:"pause.png",_resumeIMG:"resume.png",get gamePaused(){return this._gamePaused},_initiate:function(){this._button.addEventListener("click",this._clickAction.bind(this))},_clickAction:function(){this._gamePaused?(this._setImage(this._pauseIMG),this._resumeMethod()):(this._setImage(this._resumeIMG),this._pauseMethod()),this._gamePaused=!this._gamePaused},_setImage:function(t){this._button.src=this._imgDirectory+t}};var CreatureStatsBlock=function(t){null!==document.getElementById(this._blockContainerId)?(this._DOMblock=DOMUtility.createDivWithClass(this._class),CreatureStatsBlock.prototype._numBlocks++,this._index=this._numBlocks,this._image,this._ageStat,this._dayBornStat,this._createAllStats(t),this._appendStatsToBlock()):CreatureStatsBlock.prototype._numBlocks=0};CreatureStatsBlock.prototype={constructor:CreatureStatsBlock,_blockContainerId:"block-container",_class:"stats-block",_numBlocks:0,get index(){return this._index},_createAllStats:function(t){this._createImage(t.sprite),this._createStat("_ageStat","Age: ",t.ageInDays),this._createStat("_dayBornStat","Day Born: ",t.dayBorn)},_createImage:function(t){this._image=document.createElement("div"),this._image.className="sidebar-sprite",this._image.appendChild(t.getImageCopy());var e=document.createElement("p");e.textContent=this._numBlocks,this._image.appendChild(e),this._DOMblock.appendChild(this._image)},_createStat:function(t,e,o){this[t]||(this[t]=document.createElement("P"),this._updateStat(t,e,o),this._DOMblock.appendChild(this[t]))},_appendStatsToBlock:function(){document.getElementById("block-container").appendChild(this._DOMblock)},updateAgeStat:function(t){this._updateStat("_ageStat","Age: ",t)},_updateStat:function(t,e,o){this[t].textContent=e+o},grayscaleImage:function(){this._image.style.filter="grayscale(100%)",this._image.style.filter="gray"}};var AnimalStatsBlock=function(t){this._foodMeterStat,this._creaturesKilledStat,CreatureStatsBlock.call(this,t)};AnimalStatsBlock.prototype=Object.create(CreatureStatsBlock.prototype),AnimalStatsBlock.prototype.constructor=AnimalStatsBlock,AnimalStatsBlock.prototype._createAllStats=function(t){CreatureStatsBlock.prototype._createAllStats.call(this,t),this._createStat("_foodMeterStat","Food Meter: ",t.foodMeterLevel),this._createStat("_creaturesKilledStat","Creatures Killed: ",t.creaturesKilled)},AnimalStatsBlock.prototype.updateFoodMeterStat=function(t){this._updateStat("_foodMeterStat","Food Meter: ",t)},AnimalStatsBlock.prototype.updateCreaturesKilledStat=function(t){this._updateStat("_creaturesKilledStat","Creatures Killed: ",t)};var CactusStatsBlock=function(t){this._healthStat,CreatureStatsBlock.call(this,t)};CactusStatsBlock.prototype=Object.create(CreatureStatsBlock.prototype),CactusStatsBlock.prototype.constructor=CactusStatsBlock,CactusStatsBlock.prototype._createAllStats=function(t){CreatureStatsBlock.prototype._createAllStats.call(this,t),this._createStat("_healthStat","Health: ",t.health)},CactusStatsBlock.prototype.updateHealthStat=function(t){this._updateStat("_healthStat","Health: ",t)};var Behavior=function(t){this._activeTimer=null,this._creature=t,this._game,this._moveRandomDirection,this._moveSpeed=0,this._steps=0};Behavior.prototype={constructor:Behavior,_directions:[GameMap.prototype.moveCreatureUp,GameMap.prototype.moveCreatureDown,GameMap.prototype.moveCreatureLeft,GameMap.prototype.moveCreatureRight],initialize:function(t){if(!(t instanceof Game))throw TypeError("'game_' is not an instance of Game");null!==this._activeTimer&&this.stopActivity(),this._game=t,this._moveSpeed=this._creature.speed?this._creature.speed.getRandom(this._game.speed):0,this._nextSequence()},_sequence:function(){this._commands(),this._actionAfterMove(),this._nextSequence()},_commands:function(){0===this._steps&&(this._steps=this._generateNumSteps(),this._moveRandomDirection=this._getRandomDirection()),this._moveSpeed=this._creature.speed.getRandom(this._game.speed),this._moveRandomDirection(),this._steps--},_actionAfterMove:function(){var t=this._searchScope(1,this._tileIsPrey);t&&this._huntForPrey(t),(t=this._searchScope(1,this._tileIsSameSpecies))&&this._reproduce(this._game.map.getAtLocation(t))},_nextSequence:function(){this._activeTimer=setTimeout(function(t){t._sequence()},this._moveSpeed,this)},_generateNumSteps:function(){Object.throwImplementationError(this.constructor.name,"_generateNumSteps")},_getRandomDirection:function(){return function(){this._directions[Math.genRndNum(0,3)].call(this._game.map,this._creature,this._moveSpeed)}},stopActivity:function(){clearTimeout(this._activeTimer),this._activeTimer=null},_searchRadius:function(t,e){for(var o,i,r,n,a,s=1;s<=t;s++){o=this._creature.position.col-s,i=this._creature.position.col+s,r=this._creature.position.row-s,n=this._creature.position.row+s;for(var c=0,p=2*s;c<p;c++){if(a=new Position(n-c,o),e.call(this,a))return a;if(a=new Position(r+c,i),e.call(this,a))return a;if(a=new Position(r,o+c),e.call(this,a))return a;if(a=new Position(n,i-c),e.call(this,a))return a}}return!1},_searchScope:function(t,e){for(var o,i=this._creature.position,r=1;r<=t;r++){if(o=new Position(i.row-r,i.col),e.call(this,o))return o;if(o=new Position(i.row+r,i.col),e.call(this,o))return o;if(o=new Position(i.row,i.col-r),e.call(this,o))return o;if(o=new Position(i.row,i.col+r),e.call(this,o))return o}return!1},_searchDiagScope:function(t,e){for(var o,i=this._creature.position,r=1;r<=t;r++){if(o=new Position(i.row-r,i.col-r),e.call(this,o))return o;if(o=new Position(i.row-r,i.col+r),e.call(this,o))return o;if(o=new Position(i.row+r,i.col-r),e.call(this,o))return o;if(o=new Position(i.row+r,i.col+r),e.call(this,o))return o}return!1},_tileIsEmpty:function(t){return 0===this._game.map.getAtLocation(t)},_tileIsSameSpecies:function(t){return this._creature.constructor===this._game.map.getAtLocation(t).constructor},_tileIsPrey:function(t){return this._creature.isPrey(this._game.map.getAtLocation(t))},_tileIsPredator:function(t){return this._creature.isPredator(this._game.map.getAtLocation(t))},_approachPrey:function(t){var e=this._creature.speed.getMax(this._game.speed),o=t.col,i=t.row,r=this._creature.position.col,n=this._creature.position.row;o<r&&this._game.map.moveCreatureLeft(this._creature,e)||o>r&&this._game.map.moveCreatureRight(this._creature,e)||i<n&&this._game.map.moveCreatureUp(this._creature,e)||i>n&&this._game.map.moveCreatureDown(this._creature,e)},_attackEnemy:function(t){var e=this._game.map.getAtLocation(t);this._creature.isPredator(e)&&this._creature.foodMeterLevel>e.foodMeterLevel&&e.markAsDead()},_huntForPrey:function(t){var e=this._game.map.getAtLocation(t);this._creature.canEat()&&this._creature.isPrey(e)&&(e.markAsDead(),this._creature.incFoodMeter())},_reproduce:function(t){void 0!==t&&this._creature!==t&&this._creature.constructor===t.constructor&&this._creature.canReproduce()&&t.canReproduce()&&this._createChild(t)},_createChild:function(t){for(var e,o=0;o<this._creature.numChildren;o++)(e=this._searchScope(1,this._tileIsEmpty))&&this._game.initializeNewCreature(this._creature.constructor,e);this._creature.resetHoursSinceRepr(),void 0!==t&&t.resetHoursSinceRepr()},_runFromPredator:function(t){var e=this._creature.speed.getMax(this._game.speed),o=t.col,i=t.row,r=this._creature.position.col,n=this._creature.position.row;o<r&&this._game.map.moveCreatureRight(this._creature,e)||o>r&&this._game.map.moveCreatureLeft(this._creature,e)||i<n&&this._game.map.moveCreatureDown(this._creature,e)||i>n&&this._game.map.moveCreatureUp(this._creature,e)}};var ErraticBehavior=function(t){Behavior.call(this,t)};ErraticBehavior.prototype=Object.create(Behavior.prototype),ErraticBehavior.prototype.constructor=ErraticBehavior,ErraticBehavior.prototype._generateNumSteps=function(){return 1};var MildBehavior=function(t){Behavior.call(this,t)};MildBehavior.prototype=Object.create(Behavior.prototype),MildBehavior.prototype.constructor=MildBehavior,MildBehavior.prototype._generateNumSteps=function(){return Math.genRndNum(1,Math.floor(Math.sqrt(this._game.map.size)))};var LinearBehavior=function(t){Behavior.call(this,t)};LinearBehavior.prototype=Object.create(Behavior.prototype),LinearBehavior.prototype.constructor=LinearBehavior,LinearBehavior.prototype._generateNumSteps=function(){return Math.genRndNum(2,this._game.map.size-1)};var PlantBehavior=function(t){Behavior.call(this,t)};PlantBehavior.prototype=Object.create(Behavior.prototype),PlantBehavior.prototype.constructor=PlantBehavior,PlantBehavior.prototype._commands=function(){this._reproduce()},PlantBehavior.prototype._actionAfterMove=function(){},PlantBehavior.prototype._generateNumSteps=function(){return 0},PlantBehavior.prototype._reproduce=function(){this._creature.canReproduce()&&this._createChild()};var Creature=function(t,e){this._age=0,this._behavior=new this._behaviorType(this),this._dayBorn=e||1,this._hoursSinceReproduction=0,this._inAnimation=!1,this._isDead=!1,this._position=t,this._statsBlock=new this._statsBlockType(this)};Creature.prototype={constructor:Creature,_cooldownAfterRepr:Clock.convertDaysToHours(3),_maturityPercent:.33,_numChildren:1,_statsBlockType:CreatureStatsBlock,_behaviorType:void 0,_lifespan:void 0,_predatorList:void 0,_sprite:void 0,get ageInDays(){return Clock.convertHoursToDays(this._age)},get dayBorn(){return this._dayBorn},get inAnimation(){return this._inAnimation},get isDead(){return this._isDead},get numChildren(){return this._numChildren},get position(){return this._position.clone()},get sidebarIndex(){return this._statsBlock.index},get sprite(){return this._sprite},validateSpeciesClass:function(){Object.validateClass(this,["_lifespan","_predatorList","_sprite"])},incAge:function(){this._age++,this._statsBlock.updateAgeStat(this.ageInDays),this._hoursSinceReproduction++,this.atEndOfLife()&&this.markAsDead()},atEndOfLife:function(){return this._age>=this._lifespan},markAsDead:function(){this._isDead=!0,this.stopBehavior(),this._statsBlock.grayscaleImage()},isPredator:function(t){return-1!==this._predatorList.indexOf(t.constructor)},canReproduce:function(){return this._age>=this._lifespan*this._maturityPercent&&this._hoursSinceReproduction>this._cooldownAfterRepr},resetHoursSinceRepr:function(){this._hoursSinceReproduction=0},initializeBehavior:function(t){this._behavior.initialize(t)},stopBehavior:function(){this._behavior.stopActivity()},toggleInAnimation:function(){this._inAnimation=!this._inAnimation}};var Animal=function(t,e){this._creaturesKilled=0,this._foodMeter=new FoodMeter(3),this._hoursSinceLastMeal=0,Creature.call(this,t,e)};Animal.prototype=Object.create(Creature.prototype),Animal.prototype.constructor=Animal,Animal.prototype._cooldownAfterMeal=Clock.convertDaysToHours(1),Animal.prototype._hoursToDecFoodMeter=Clock.convertDaysToHours(2),Animal.prototype._statsBlockType=AnimalStatsBlock,Animal.prototype._speed=void 0,Animal.prototype._preyList=void 0,Object.defineProperties(Animal.prototype,{creaturesKilled:{get:function(){return this._creaturesKilled}},foodMeterLevel:{get:function(){return this._foodMeter.level}},speed:{get:function(){return this._speed}},preyList:{get:function(){return this._preyList}}}),Animal.prototype.validateSpeciesClass=function(){Creature.prototype.validateSpeciesClass.call(this),Object.validateClass(this,["_preyList","_speed"])},Animal.prototype.incAge=function(){Creature.prototype.incAge.call(this),this._incHoursSinceLastMeal()},Animal.prototype._incHoursSinceLastMeal=function(){++this._hoursSinceLastMeal%this._hoursToDecFoodMeter==0&&this.decFoodMeter()},Animal.prototype.canEat=function(){return!this._foodMeter.isFull()&&this._hoursSinceLastMeal>this._cooldownAfterMeal},Animal.prototype.foodMeterIsEmpty=function(){return this._foodMeter.isEmpty()},Animal.prototype.foodMeterIsFull=function(){return this._foodMeter.isFull()},Animal.prototype.decFoodMeter=function(){this._foodMeter.dec(),this._statsBlock.updateFoodMeterStat(this.foodMeterLevel),this.foodMeterIsEmpty()&&this.markAsDead()},Animal.prototype.incFoodMeter=function(){this._foodMeter.inc()&&(this._creaturesKilled++,this._statsBlock.updateFoodMeterStat(this.foodMeterLevel),this._statsBlock.updateCreaturesKilledStat(this._creaturesKilled),this._hoursSinceLastMeal=0)},Animal.prototype.isPrey=function(t){return-1!==this._preyList.indexOf(t.constructor)},Animal.prototype.move=function(t){this._position=t.clone()};var Game=function(t,e){this._validateGameClass(),this._clock=new Clock(this._defaultSpeed,this._actionPerHour.bind(this)),this._creatureList=new CreatureList,this._map=new GameMap(t,this._mapBgFile),this._pauseButton=new PauseButton(this._stopTime.bind(this),this._resumeTime.bind(this)),this._setSidebarBg(),this._initiateReturnArrow(),this._spawnAllObjects(e),setTimeout(function(){this._resumeTime()}.bind(this),1e3)};Game.prototype={constructor:Game,_defaultSpeed:2400,_mapBgFile:void 0,_obstacleList:void 0,_obstaclePercent:void 0,_sidebarBgFile:void 0,_speciesList:void 0,get defaultSpeed(){return Game.prototype._defaultSpeed},get speed(){return this._clock.speed},get map(){return this._map},get mapBgFile(){return this._mapBgFile},get obstacleList(){return this._obstacleList},get obstaclePercent(){return this._obstaclePercent},get sidebarBgFile(){return this._sidebarBgFile},get speciesList(){return this._speciesList},_validateGameClass:function(){Object.validateClass(this,["_mapBgFile","_obstacleList","_obstaclePercent","_sidebarBgFile","_speciesList"]);for(var t=0;t<this._speciesList.length;t++)this._speciesList[t].prototype.validateSpeciesClass()},_setSidebarBg:function(){document.getElementById("stats-sidebar").style.background="url('images/backgrounds/"+this._sidebarBgFile+"') repeat"},_initiateReturnArrow:function(){var t=this;document.getElementById("return-arrow").addEventListener("click",function(){t._stopTime(),DOMUtility.loadHtmlTemplate("MapEdit",function(){mapEdit.initiateAssets()})})},_spawnAllObjects:function(t){if(!(t instanceof ObjectList))throw TypeError("objectList is not an instance of ObjectList");for(var e,o,i=0,r=t.length;i<r;i++)e=new((o=t.get(i)).class)(o.position),this._map.setAtLocation(e,e.position),e instanceof Creature&&this._creatureList.add(e)},initializeNewCreature:function(t,e){if(!(t.prototype instanceof Creature))throw TypeError("CreatureClass is not a constructor for a creature");var o=new t(e,this._clock.day);this._creatureList.add(o),this._map.setAtLocation(o,e),o.initializeBehavior(this)},_actionPerHour:function(){this._creatureList.noAnimalsLeft()?this._endGame():this._incAllCreatureAges()},_incAllCreatureAges:function(){for(var t,e=0;e<this._creatureList.length;e++)(t=this._creatureList.get(e)).incAge(),t.isDead&&this._removeCreature(t)},_removeCreature:function(t){t.inAnimation||(this._map.clearLocation(t),this._creatureList.remove(t),t.stopBehavior())},_endGame:function(){this._stopTime(),this._map.showGameOverScreen()},_stopTime:function(){this._clock.pause();for(var t=0,e=this._creatureList.length;t<e;t++)this._creatureList.get(t).stopBehavior()},_resumeTime:function(){this._clock.start();for(var t=0,e=this._creatureList.length;t<e;t++)this._creatureList.get(t).initializeBehavior(this)}};var Tree=function(t){Obstacle.call(this,t)};Tree.prototype=Object.create(Obstacle.prototype),Tree.prototype.constructor=Tree,Tree.prototype._sprite=new ObstacleSprite("tree.png",2,1);var DeerBehavior=function(t){MildBehavior.call(this,t)};DeerBehavior.parent=MildBehavior,DeerBehavior.prototype=Object.create(DeerBehavior.parent.prototype),DeerBehavior.prototype.constructor=DeerBehavior,DeerBehavior.prototype._commands=function(){var t=this._searchRadius(2,this._tileIsPredator);this._creature.foodMeterLevel<=3&&t?(this._runFromPredator(t),this._moveSpeed=this._creature.speed.getMax(this._game.speed),this._steps=0):DeerBehavior.parent.prototype._commands.call(this)};var BoarBehavior=function(t){ErraticBehavior.call(this,t)};BoarBehavior.parent=ErraticBehavior,BoarBehavior.prototype=Object.create(BoarBehavior.parent.prototype),BoarBehavior.prototype.constructor=BoarBehavior,BoarBehavior.prototype._commands=function(){var t=this._searchScope(this._creature.sightRange,this._tileIsPrey);this._creature.foodMeterLevel<=2&&this._creature.canEat()&&t?(this._approachPrey(t),this._moveSpeed=this._creature.speed.getMax(this._game.speed)):BoarBehavior.parent.prototype._commands.call(this)};var BearBehavior=function(t){ErraticBehavior.call(this,t)};BearBehavior.parent=ErraticBehavior,BearBehavior.prototype=Object.create(BearBehavior.parent.prototype),BearBehavior.prototype.constructor=BoarBehavior,BearBehavior.prototype._commands=function(){var t=this._searchRadius(2,this._tileIsPrey);1===this._creature.foodMeterLevel&&this._creature.canEat()&&t?(this._approachPrey(t),this._moveSpeed=this._creature.speed.getMax(this._game.speed)):BearBehavior.parent.prototype._commands.call(this)};var Fern=function(t,e){Creature.call(this,t,e)};Fern.prototype=Object.create(Creature.prototype),Fern.prototype.constructor=Fern,Fern.prototype._behaviorType=PlantBehavior,Fern.prototype._cooldownAfterRepr=Clock.convertDaysToHours(6),Fern.prototype._lifespan=Clock.convertDaysToHours(12),Fern.prototype._maturityPercent=.4,Fern.prototype._numChildren=2,Fern.prototype._predatorList=[Deer,Boar],Fern.prototype._sprite=new Sprite("fern.png",1,1);var Deer=function(t,e){Animal.call(this,t,e)};Deer.prototype=Object.create(Animal.prototype),Deer.prototype.constructor=Deer,Deer.prototype._behaviorType=DeerBehavior,Deer.prototype._lifespan=Clock.convertDaysToHours(15),Deer.prototype._numChildren=2,Deer.prototype._predatorList=[Boar,Bear],Deer.prototype._preyList=[Fern],Deer.prototype._speed=new MoveSpeed(.75,2),Deer.prototype._sprite=new AnimatedSprite("deer.png","deer-sheet.png",1,1);var Boar=function(t,e){Animal.call(this,t,e),this._sightRange=1};Boar.prototype=Object.create(Animal.prototype),Boar.prototype.constructor=Boar,Boar.prototype._behaviorType=BoarBehavior,Boar.prototype._lifespan=Clock.convertDaysToHours(12),Boar.prototype._predatorList=[Bear],Boar.prototype._preyList=[Fern,Deer],Boar.prototype._speed=new MoveSpeed(1,1.25),Boar.prototype._sprite=new AnimatedSprite("boar.png","boar-sheet.png",1,1),Object.defineProperties(Boar.prototype,{sightRange:{get:function(){return this._sightRange}}}),Boar.prototype.decFoodMeter=function(){Animal.prototype.decFoodMeter.call(this),this._adjustSightRange()},Boar.prototype.incFoodMeter=function(){Animal.prototype.incFoodMeter.call(this),this._adjustSightRange()},Boar.prototype._adjustSightRange=function(){switch(this._foodMeter.level){case 1:this._sightRange=4;break;case 2:this._sightRange=2;break;default:this._sightRange=1}};var Bear=function(t,e){Animal.call(this,t,e),this._speed=new HungerBasedMoveSpeed(this._foodMeter)};Bear.prototype=Object.create(Animal.prototype),Bear.prototype.constructor=Bear,Bear.prototype._behaviorType=BearBehavior,Bear.prototype._lifespan=Clock.convertDaysToHours(15),Bear.prototype._maturityPercent=.5,Bear.prototype._predatorList=[],Bear.prototype._preyList=[Deer,Boar],Bear.prototype._speed=null,Bear.prototype._sprite=new AnimatedSprite("bear.png","bear-sheet.png",1,1);var JungleGame=function(t,e){Game.call(this,t,e)};JungleGame.prototype=Object.create(Game.prototype),JungleGame.prototype.constructor=JungleGame,JungleGame.prototype._mapBgFile="jungle.png",JungleGame.prototype._obstacleList=[Tree],JungleGame.prototype._obstaclePercent=.25,JungleGame.prototype._sidebarBgFile="jungle_tile.png",JungleGame.prototype._speciesList=[Fern,Deer,Boar,Bear];var Rock=function(t){Obstacle.call(this,t)};Rock.prototype=Object.create(Obstacle.prototype),Rock.prototype.constructor=Rock,Rock.prototype._sprite=new ObstacleSprite("rock.png",1,1);var SnakeBehavior=function(t){ErraticBehavior.call(this,t)};SnakeBehavior.parent=ErraticBehavior,SnakeBehavior.prototype=Object.create(SnakeBehavior.parent.prototype),SnakeBehavior.prototype.constructor=SnakeBehavior,SnakeBehavior.prototype._commands=function(){var t=this._searchRadius(1,this._tileIsPredator);t&&this._action.attackEnemy(t),SnakeBehavior.parent.prototype._commands.call(this)};var CoyoteBehavior=function(t){MildBehavior.call(this,t)};CoyoteBehavior.parent=MildBehavior,CoyoteBehavior.prototype=Object.create(CoyoteBehavior.parent.prototype),CoyoteBehavior.prototype.constructor=CoyoteBehavior,CoyoteBehavior.prototype._commands=function(){var t=this._searchScope(this._game.map.size-1,this._tileIsPrey);1===this._creature.foodMeterLevel&&this._creature.canEat()&&t?(this._approachPrey(t),this._moveSpeed=this._creature.speed.getMax(this._game.speed)):4===this._creature.foodMeterLevel?(this._moveSpeed=this._creature.speed.getMax(this._game.speed),this._moveRandomDirection(),this._steps--):CoyoteBehavior.parent.prototype._commands.call(this)};var Cactus=function(t,e){this._health=3,Creature.call(this,t,e)};Cactus.prototype=Object.create(Creature.prototype),Cactus.prototype.constructor=Cactus,Cactus.prototype._behaviorType=PlantBehavior,Cactus.prototype._lifespan=Clock.convertDaysToHours(20),Cactus.prototype._cooldownAfterRepr=Cactus.prototype._lifespan/2,Cactus.prototype._maturityPercent=.45,Cactus.prototype._predatorList=[Iguana],Cactus.prototype._sprite=new Sprite("cactus.png",1,1),Cactus.prototype._statsBlockType=CactusStatsBlock,Object.defineProperties(Cactus.prototype,{health:{get:function(){return this._health}}}),Cactus.prototype.markAsDead=function(){this._health>0&&this._health--,this._statsBlock.updateHealthStat(this._health),0===this._health&&Creature.prototype.markAsDead.call(this)};var Iguana=function(t,e){Animal.call(this,t,e)};Iguana.prototype=Object.create(Animal.prototype),Iguana.prototype.constructor=Iguana,Iguana.prototype._behaviorType=LinearBehavior,Iguana.prototype._lifespan=Clock.convertDaysToHours(8),Iguana.prototype._hoursToDecFoodMeter=Clock.convertDaysToHours(1.5),Iguana.prototype._maturityPercent=.6,Iguana.prototype._numChildren=3,Iguana.prototype._predatorList=[Snake,Coyote],Iguana.prototype._preyList=[Cactus],Iguana.prototype._speed=new MoveSpeed(.6,.9),Iguana.prototype._sprite=new AnimatedSprite("iguana.png","iguana-sheet.png",1,1);var Snake=function(t,e){Animal.call(this,t,e)};Snake.prototype=Object.create(Animal.prototype),Snake.prototype.constructor=Snake,Snake.prototype._behaviorType=SnakeBehavior,Snake.prototype._lifespan=Clock.convertDaysToHours(12),Snake.prototype._numChildren=2,Snake.prototype._predatorList=[Coyote],Snake.prototype._preyList=[Iguana],Snake.prototype._speed=new MoveSpeed(1.5,2.5),Snake.prototype._sprite=new AnimatedSprite("snake.png","snake-sheet.png",1,1);var Coyote=function(t,e){Animal.call(this,t,e)};Coyote.prototype=Object.create(Animal.prototype),Coyote.prototype.constructor=Coyote,Coyote.prototype._behaviorType=CoyoteBehavior,Coyote.prototype._lifespan=Clock.convertDaysToHours(10),Coyote.prototype._maturityPercent=.5,Coyote.prototype._predatorList=[],Coyote.prototype._preyList=[Iguana,Snake],Coyote.prototype._speed=new MoveSpeed(.75,1.75),Coyote.prototype._sprite=new AnimatedSprite("coyote.png","coyote-sheet.png",1,1);var DesertGame=function(t,e){Game.call(this,t,e)};DesertGame.prototype=Object.create(Game.prototype),DesertGame.prototype.constructor=DesertGame,DesertGame.prototype._mapBgFile="desert.png",DesertGame.prototype._obstacleList=[Rock],DesertGame.prototype._obstaclePercent=.05,DesertGame.prototype._sidebarBgFile="desert_tile.png",DesertGame.prototype._speciesList=[Cactus,Iguana,Snake,Coyote];var PlanktonBehavior=function(t){ErraticBehavior.call(this,t)};PlanktonBehavior.parent=ErraticBehavior,PlanktonBehavior.prototype=Object.create(PlanktonBehavior.parent.prototype),PlanktonBehavior.prototype.constructor=PlanktonBehavior,PlanktonBehavior.prototype._actionAfterMove=function(){},TunaBehavior=function(t){LinearBehavior.call(this,t)},TunaBehavior.parent=LinearBehavior,TunaBehavior.prototype=Object.create(TunaBehavior.parent.prototype),TunaBehavior.prototype.constructor=TunaBehavior,TunaBehavior.prototype._commands=function(){var t=this._searchRadius(3,this._tileIsPredator);this._creature.foodMeterLevel<=2&&t?(this._runFromPredator(t),this._moveSpeed=this._creature.speed.getMax(this._game.speed),this._steps=0):TunaBehavior.parent.prototype._commands.call(this)};var OctopusBehavior=function(t){MildBehavior.call(this,t)};OctopusBehavior.parent=MildBehavior,OctopusBehavior.prototype=Object.create(OctopusBehavior.parent.prototype),OctopusBehavior.prototype.constructor=OctopusBehavior,OctopusBehavior.prototype._commands=function(){var t=this._searchDiagScope(2,this._tileIsPrey);2===this._creature.foodMeterLevel&&this._creature.canEat()&&t?(this._approachPrey(t),this._moveSpeed=this._creature.speed.getMax(this._game.speed)):OctopusBehavior.parent.prototype._commands.call(this)},OctopusBehavior.prototype._actionAfterMove=function(){var t=this._searchDiagScope(1,this._tileIsPrey);t&&this._huntForPrey(t),(t=this._searchDiagScope(1,this._tileIsSameSpecies))&&this._reproduce(this._game.map.getAtLocation(t))};var Plankton=function(t,e){Creature.call(this,t,e)};Plankton.prototype=Object.create(Creature.prototype),Plankton.prototype.constructor=Plankton,Plankton.prototype._behaviorType=PlanktonBehavior,Plankton.prototype._lifespan=0,Plankton.prototype._predatorList=[Tuna,Octopus],Plankton.prototype._speed=new MoveSpeed(8,8),Plankton.prototype._sprite=new AnimatedSprite("plankton.png","plankton-sheet.png",1,1),Object.defineProperties(Plankton.prototype,{speed:{get:function(){return this._speed}}}),Plankton.prototype.markAsDead=function(){},Plankton.prototype.move=function(t){this._position=t.clone()};var Tuna=function(t,e){Animal.call(this,t,e)};Tuna.prototype=Object.create(Animal.prototype),Tuna.prototype.constructor=Tuna,Tuna.prototype._behaviorType=TunaBehavior,Tuna.prototype._lifespan=Clock.convertDaysToHours(15),Tuna.prototype._numChildren=2,Tuna.prototype._predatorList=[Octopus,Shark],Tuna.prototype._preyList=[Plankton],Tuna.prototype._speed=new MoveSpeed(.6,3),Tuna.prototype._sprite=new AnimatedSprite("tuna.png","tuna-sheet.png",1,1);var Octopus=function(t,e){Animal.call(this,t,e)};Octopus.prototype=Object.create(Animal.prototype),Octopus.prototype.constructor=Octopus,Octopus.prototype._behaviorType=OctopusBehavior,Octopus.prototype._hoursToDecFoodMeter=Clock.convertDaysToHours(1.5),Octopus.prototype._lifespan=Clock.convertDaysToHours(10),Octopus.prototype._maturityPercent=.15,Octopus.prototype._predatorList=[Shark],Octopus.prototype._preyList=[Plankton,Tuna],Octopus.prototype._speed=new MoveSpeed(.9,1.2),Octopus.prototype._sprite=new AnimatedSprite("octopus.png","octopus-sheet.png",1,1),Octopus.prototype.isPrey=function(t){return 1===this._foodMeter.level&&t instanceof Octopus||Animal.prototype.isPrey.call(this,t)};var Shark=function(t,e){Animal.call(this,t,e)};Shark.prototype=Object.create(Animal.prototype),Shark.prototype.constructor=Shark,Shark.prototype._behaviorType=LinearBehavior,Shark.prototype._cooldownAfterMeal=Clock.convertDaysToHours(1.5),Shark.prototype._hoursToDecFoodMeter=Clock.convertDaysToHours(3),Shark.prototype._lifespan=Clock.convertDaysToHours(22),Shark.prototype._predatorList=[],Shark.prototype._preyList=[Tuna,Octopus],Shark.prototype._speed=new MoveSpeed(2,4),Shark.prototype._sprite=new AnimatedSprite("shark.png","shark-sheet.png",1,1);var OceanGame=function(t,e){Game.call(this,t,e)};OceanGame.prototype=Object.create(Game.prototype),OceanGame.prototype.constructor=OceanGame,OceanGame.prototype._mapBgFile="ocean.png",OceanGame.prototype._obstacleList=[],OceanGame.prototype._obstaclePercent=0,OceanGame.prototype._sidebarBgFile="ocean_tile.png",OceanGame.prototype._speciesList=[Plankton,Tuna,Octopus,Shark];var MainMenu=function(){this._chosenOption=1,this._options=DOMUtility.assignElementById("menu-options").getElementsByTagName("li"),this._screens=document.getElementsByClassName("second-menu-screen"),this.initiateAssets()};MainMenu.prototype={constructor:MainMenu,initiateAssets:function(){this._initiateStartGameButton(),this._initiateOptionClick(),this._changeScreen(this._chosenOption)},_initiateStartGameButton:function(){this._options[0].addEventListener("click",function(){DOMUtility.loadHtmlTemplate("MapEdit",function(){mapEdit=new MapEditScreen})})},_initiateOptionClick:function(){for(var t=this,e=1;e<this._options.length;e++)this._options[e].addEventListener("click",function(e){return function(){t._changeScreen(e)}}(e))},_changeScreen:function(t){this._validateOption(t),this._screens[this._chosenOption-1].style.display="none",this._screens[t-1].style.display="block",this._chosenOption=t},_validateOption:function(t){if(t<1||t>=this._options.length)throw RangeError("option index must be a number between 1 and "+this._options.length)}};var MapEditScreen=function(){this._currentEnvIndex=0,this._environmentSelector,this._mapPreview,this._mapSize=this._minMapSize,this._randomEnabled=!1,this._speciesImages,this._resetMap(),this.initiateAssets()};MapEditScreen.prototype={_id:"game",_bgPath:"images/backgrounds/",_buttonsPath:"images/buttons/",_environmentList:[JungleGame,DesertGame,OceanGame],_environmentNames:["Jungle","Desert","Ocean"],_minMapSize:6,_maxMapSize:15,_speciesDescrFileNames:["jungle-desc.png","desert-desc.png","ocean-desc.png"],_speciesDescrPath:"images/descriptions/",get _currentEnv(){return this._environmentList[this._currentEnvIndex]},get _currentEnvName(){return this._environmentNames[this._currentEnvIndex]},get _speciesList(){return this._currentEnv.prototype.speciesList},get _selectedSpecies(){return this._speciesList[this._selectedSpeciesIndex]},get _speciesDescr(){return this._speciesDescrPath+this._speciesDescrFileNames[this._currentEnvIndex]},_resetMap:function(){this._createNewMap(),this._mapPreview.generateObstacles(this._currentEnv.prototype),this._randomEnabled&&this._mapPreview.spawnRandomCreatures(this._speciesList)},_createNewMap:function(t){this._mapPreview=new MapPreview(this._mapSize,this._currentEnv.prototype.mapBgFile,this._selectedSpecies,t)},initiateAssets:function(){this._environmentSelector=DOMUtility.assignElementById("environment-selector"),this._speciesImages=DOMUtility.assignElementById("species-list").getElementsByTagName("IMG"),this._updateEnvironmentType(),this._initiateArrows(),this._initiateSpeciesSelect(),this._initiateButtons(),this._createNewMap(this._mapPreview.objectList)},_updateEnvironmentType:function(){this._updateEnvironmentName(),this._updateBackground(),this._updateSpeciesDetails(),this._updateSpeciesImages()},_updateEnvironmentName:function(){this._environmentSelector.getElementsByTagName("P")[0].innerHTML=this._currentEnvName},_updateBackground:function(){document.getElementById(this._id).style.background="url('"+this._bgPath+this._currentEnv.prototype.sidebarBgFile+"')"},_updateSpeciesDetails:function(){document.getElementById("species-description").firstElementChild.src=this._speciesDescr},_updateSpeciesImages:function(){for(var t=0;t<this._speciesList.length;t++)this._speciesImages[t].src=this._speciesList[t].prototype.sprite.image.src;this._setSelectedSpecies(this._speciesImages[0])},_initiateSpeciesSelect:function(){var t=this;DOMUtility.assignElementById("species-list").addEventListener("click",function(e){t._setSelectedSpecies(e.target)})},_setSelectedSpecies:function(t){if("IMG"===t.tagName){for(var e=0;e<this._speciesImages.length;e++)this._speciesImages[e].style.backgroundColor="",this._speciesImages[e]===t&&(this._selectedSpeciesIndex=e);t.style.backgroundColor="rgba(11,11,11,0.5)",this._mapPreview.newSelectedSpecies(this._selectedSpecies)}},_initiateArrows:function(){this._initiateEnvironmentArrows(),this._initiateMapSizeArrows()},_initiateEnvironmentArrows:function(){var t=this._environmentSelector.getElementsByClassName("arrow-button"),e=this;t[0].addEventListener("click",function(){0===e._currentEnvIndex?e._currentEnvIndex=e._environmentList.length-1:e._currentEnvIndex--,e._updateEnvironmentType(),e._resetMap()}),t[1].addEventListener("click",function(){e._currentEnvIndex===e._environmentList.length-1?e._currentEnvIndex=0:e._currentEnvIndex++,e._updateEnvironmentType(),e._resetMap()})},_initiateMapSizeArrows:function(){var t=this,e=DOMUtility.assignElementById("size-selector"),o=e.getElementsByClassName("arrow-button"),i=e.getElementsByTagName("P")[0];i.innerHTML=t._mapSize,o[0].addEventListener("click",function(){t._mapSize!==t._minMapSize&&(t._mapSize--,i.innerHTML=t._mapSize,t._resetMap())}),o[1].addEventListener("click",function(){t._mapSize!==t._maxMapSize&&(t._mapSize++,i.innerHTML=t._mapSize,t._resetMap())})},_initiateButtons:function(){var t=this,e=document.getElementsByClassName("button");e[0].addEventListener("click",function(){DOMUtility.loadHtmlTemplate("Game",function(){game=new t._currentEnv(t._mapSize,t._mapPreview.objectList)})}),e[1].addEventListener("click",function(){t._resetMap()}),this._initiateRandomButtom(),this._initiateReturnButton(),this._initiateHelpButtons()},_initiateRandomButtom:function(){var t=this;document.getElementById("random-toggle").getElementsByTagName("IMG")[0].addEventListener("click",function(e){t._randomEnabled=!t._randomEnabled,e.target.src=t._buttonsPath+(t._randomEnabled?"on.png":"off.png"),t._randomEnabled&&t._mapPreview.spawnRandomCreatures(t._speciesList)}),t._randomEnabled=!1},_initiateReturnButton:function(){document.getElementById("return-arrow").addEventListener("click",function(){DOMUtility.loadHtmlTemplate("MainMenu",function(){menu=new MainMenu})})},_initiateHelpButtons:function(){for(var t=document.getElementsByClassName("help-button"),e=document.getElementsByClassName("help-hover-text"),o=0;o<t.length;o++)e[o].style.left=t[o].offsetLeft.toString()+"px",e[o].style.top=(t[o].offsetTop+t[o].clientHeight).toString()+"px",t[o].addEventListener("mouseover",function(t){return function(){e[t].style.display="block"}}(o)),t[o].addEventListener("mouseout",function(t){return function(){e[t].style.display="none"}}(o))}};var mapEdit,game,menu;DOMUtility.disableRightClickMenu(),DOMUtility.listenForImageLoadFailure(),DOMUtility.preventElementHighlighting(),DOMUtility.loadHtmlTemplate("MainMenu",function(){menu=new MainMenu});